{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Virtual Machine Schema",
  "description": "Schema for Azure Virtual Machine resource in Bicep",
  "properties": {
    "apiVersion": {
      "type": "string",
      "enum": ["2021-03-01", "2021-07-01", "2022-03-01", "2022-08-01"],
      "description": "The API version for the virtual machine resource"
    },
    "type": {
      "type": "string",
      "const": "Microsoft.Compute/virtualMachines",
      "description": "The resource type for Azure Virtual Machine"
    },
    "name": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9-_.]{1,64}$",
      "description": "Virtual machine name (1-64 characters)"
    },
    "location": {
      "type": "string",
      "description": "Azure region where the VM will be created"
    },
    "properties": {
      "type": "object",
      "properties": {
        "hardwareProfile": {
          "type": "object",
          "properties": {
            "vmSize": {
              "type": "string",
              "enum": [
                "Standard_B1s", "Standard_B1ms", "Standard_B2s", "Standard_B2ms",
                "Standard_D2s_v3", "Standard_D4s_v3", "Standard_D8s_v3",
                "Standard_F2s_v2", "Standard_F4s_v2", "Standard_F8s_v2"
              ],
              "description": "Virtual machine size"
            }
          },
          "required": ["vmSize"]
        },
        "osProfile": {
          "type": "object",
          "properties": {
            "computerName": {
              "type": "string",
              "maxLength": 15,
              "description": "Computer name for the VM"
            },
            "adminUsername": {
              "type": "string",
              "description": "Admin username for the VM"
            },
            "adminPassword": {
              "type": "string",
              "description": "Admin password for the VM"
            },
            "linuxConfiguration": {
              "type": "object",
              "properties": {
                "disablePasswordAuthentication": {
                  "type": "boolean"
                },
                "ssh": {
                  "type": "object",
                  "properties": {
                    "publicKeys": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "path": {
                            "type": "string"
                          },
                          "keyData": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "required": ["computerName", "adminUsername"]
        },
        "storageProfile": {
          "type": "object",
          "properties": {
            "imageReference": {
              "type": "object",
              "properties": {
                "publisher": {
                  "type": "string",
                  "description": "Image publisher"
                },
                "offer": {
                  "type": "string", 
                  "description": "Image offer"
                },
                "sku": {
                  "type": "string",
                  "description": "Image SKU"
                },
                "version": {
                  "type": "string",
                  "description": "Image version"
                }
              },
              "required": ["publisher", "offer", "sku", "version"]
            },
            "osDisk": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                },
                "caching": {
                  "type": "string",
                  "enum": ["None", "ReadOnly", "ReadWrite"]
                },
                "createOption": {
                  "type": "string",
                  "enum": ["FromImage", "Empty", "Attach"]
                },
                "managedDisk": {
                  "type": "object",
                  "properties": {
                    "storageAccountType": {
                      "type": "string",
                      "enum": ["Standard_LRS", "Premium_LRS", "StandardSSD_LRS", "UltraSSD_LRS"]
                    }
                  }
                }
              },
              "required": ["createOption"]
            }
          },
          "required": ["imageReference", "osDisk"]
        },
        "networkProfile": {
          "type": "object",
          "properties": {
            "networkInterfaces": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string",
                    "description": "Network interface resource ID"
                  }
                },
                "required": ["id"]
              }
            }
          },
          "required": ["networkInterfaces"]
        }
      },
      "required": ["hardwareProfile", "osProfile", "storageProfile", "networkProfile"]
    },
    "tags": {
      "type": "object",
      "description": "Resource tags",
      "additionalProperties": {
        "type": "string"
      }
    }
  },
  "required": ["apiVersion", "type", "name", "location", "properties"],
  "additionalProperties": false
}